# Maintaining all db creation details

## DB Name - Twar
Query - CREATE DATABASE `Twar`

### 1. kpi
Query - CREATE TABLE `kpi` (
  `id` int NOT NULL AUTO_INCREMENT,
  `daily` int DEFAULT NULL,
  `weekly` int DEFAULT NULL,
  `used_daily` int DEFAULT NULL,
  `used_weekly` int DEFAULT NULL,
  PRIMARY KEY (`id`)
)

### 2. bot
Query - CREATE TABLE `bot` (
  `id` int NOT NULL AUTO_INCREMENT,
  `screen_name` varchar(30) DEFAULT NULL,
  `kpi_id` int NOT NULL,
  `status` varchar(1) DEFAULT NULL,
  PRIMARY KEY (`id`),
  KEY `kpi_id` (`kpi_id`),
  FOREIGN KEY (`kpi_id`) REFERENCES `kpi` (`id`)
)

### 3. user_auth
Query - CREATE TABLE `user_auth` (
  `username` varchar(30) NOT NULL,
  `email` varchar(50) DEFAULT NULL,
  `password` varchar(30) NOT NULL,
  PRIMARY KEY (`username`)
)

### 4. subscription_plan
Query - CREATE TABLE `subscription_plan` (
  `id` int NOT NULL AUTO_INCREMENT,
  `name` varchar(50) NOT NULL,
  `price` int DEFAULT NULL,
  `features` text,
  PRIMARY KEY (`id`),
  UNIQUE KEY `name` (`name`)
)

### 5. user_subscription_plan
Query - CREATE TABLE `user_subscription_plan` (
  `user` varchar(30) NOT NULL,
  `subscription_plan_id` int NOT NULL,
  PRIMARY KEY (`user`),
  KEY `subscription_plan_id` (`subscription_plan_id`),
  CONSTRAINT `user_subscription_plan_ibfk_1` FOREIGN KEY (`subscription_plan_id`) REFERENCES `subscription_plan` (`id`)
)

### 6. user_bots
Query - CREATE TABLE `user_bots` (
  `id` int NOT NULL AUTO_INCREMENT,
  `username` varchar(30) NOT NULL,
  `bot_id` int NOT NULL,
  PRIMARY KEY (`id`),
  KEY `username` (`username`),
  KEY `bot_id` (`bot_id`),
  CONSTRAINT `user_bots_ibfk_1` FOREIGN KEY (`username`) REFERENCES `user_auth` (`username`),
  CONSTRAINT `user_bots_ibfk_2` FOREIGN KEY (`bot_id`) REFERENCES `bot` (`id`)
)

### 7. flows
Query - CREATE TABLE `flows` (
  `id` int NOT NULL AUTO_INCREMENT,
  `user_id` varchar(100) NOT NULL,
  PRIMARY KEY (`id`),
  KEY `user_id` (`user_id`),
  CONSTRAINT `flows_ibfk_1` FOREIGN KEY (`user_id`) REFERENCES `user_auth` (`username`) ON DELETE CASCADE ON UPDATE CASCADE
)

### 8. flow_steps
Query - CREATE TABLE `flow_steps` (
  `id` int NOT NULL AUTO_INCREMENT,
  `flow_id` int NOT NULL,
  `node_id` int NOT NULL,
  `label` varchar(255) NOT NULL,
  `user_input` text,
  PRIMARY KEY (`id`),
  KEY `flow_id` (`flow_id`),
  CONSTRAINT `flow_steps_ibfk_1` FOREIGN KEY (`flow_id`) REFERENCES `flows` (`id`) ON DELETE CASCADE ON UPDATE CASCADE
)

### 9. flow_next_step
Query - CREATE TABLE `flow_next_step` (
  `flow_id` int NOT NULL,
  `node_id` int NOT NULL,
  `next_node_id` int NOT NULL
)

